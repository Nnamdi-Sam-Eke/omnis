"use strict";(self.webpackChunkomnis=self.webpackChunkomnis||[]).push([[474],{2474:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var s=a(5043),r=a(3393),d=a(579);const i={style:{base:{fontSize:"16px",color:"#32325d","::placeholder":{color:"#a0aec0"},fontFamily:"Arial, sans-serif",":-webkit-autofill":{color:"#32325d"}},invalid:{color:"#e53e3e"}}},l=e=>{let{onSaveBillingInfo:t}=e;return function(){const[e,t]=(0,s.useState)(!0),[a,l]=(0,s.useState)(!1),[n,o]=(0,s.useState)(""),[c,g]=(0,s.useState)(""),[u,b]=(0,s.useState)(null),h=(0,r.useStripe)(),m=(0,r.useElements)();(0,s.useEffect)((()=>{const e=setTimeout((()=>t(!1)),3e3);return()=>clearTimeout(e)}),[]);return e?(0,d.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,d.jsx)("div",{className:"h-10 bg-gray-300 dark:bg-gray-700 rounded"}),(0,d.jsx)("div",{className:"h-10 bg-gray-300 dark:bg-gray-700 rounded"}),(0,d.jsx)("div",{className:"h-12 bg-blue-300 dark:bg-blue-700 rounded"})]}):(0,d.jsxs)("div",{className:"space-y-6",children:[n&&(0,d.jsx)("div",{className:"fixed top-5 right-5 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",children:n}),u&&(0,d.jsx)("div",{className:"mb-4 text-red-600 font-semibold",children:u}),(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border shadow-sm",children:[(0,d.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Payment Method"}),(0,d.jsx)("div",{className:"p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700",children:(0,d.jsx)(r.CardElement,{options:i})})]}),(0,d.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border shadow-sm",children:[(0,d.jsx)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Billing Address"}),(0,d.jsx)("input",{id:"billingAddress",name:"billingAddress",type:"text",placeholder:"123 Main St, City, State 12345",value:c,onChange:e=>g(e.target.value),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]}),(0,d.jsx)("div",{className:"flex justify-end",children:(0,d.jsx)("button",{onClick:async()=>{if(!c)return o("Please fill in the billing address."),void setTimeout((()=>o("")),3e3);if(l(!0),b(null),!h||!m)return b("Stripe has not loaded yet."),void l(!1);const e=m.getElement(r.CardElement),{error:t,paymentMethod:a}=await h.createPaymentMethod({type:"card",card:e,billing_details:{address:{line1:c}}});if(t)return b(t.message),void l(!1);try{await async function(e){let{paymentMethodId:t,billingAddress:a}=e;const s=await fetch("/api/save-payment-method",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:"currentUserId",paymentMethodId:t,billingAddress:a})});if(!s.ok)throw new Error("Failed to save billing info");return await s.json()}({paymentMethodId:a.id,billingAddress:c}),o("Billing info saved successfully!")}catch(s){o("Failed to save billing info.")}finally{l(!1),setTimeout((()=>o("")),3e3)}},disabled:a,className:"px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:a?"Saving...":"Save Billing Info"})})]})}()}}}]);
//# sourceMappingURL=474.44c14c7a.chunk.js.map