"use strict";(self.webpackChunkomnis=self.webpackChunkomnis||[]).push([[662],{3662:(e,t,o)=>{o.r(t),o.d(t,{default:()=>p});var a=o(5043),s=o(5399),r=o(5472),n=o(7304),i=(o(1987),o(6058)),l=o(5487),c=o(1045),d=o(9613),m=o(579);n.t1.register(...n.$L);const u=e=>{let{title:t,value:o,icon:a}=e;return(0,m.jsxs)(l.P.div,{className:"bg-white dark:bg-gray-900 p-6 rounded-2xl shadow-lg flex flex-col items-center text-center hover:shadow-2xl transition-shadow",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5},children:[a&&(0,m.jsx)("div",{className:"text-4xl mb-2 text-blue-500",children:a}),(0,m.jsx)("h4",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:t}),(0,m.jsx)("p",{className:"text-3xl font-bold text-green-500 mt-2",children:o})]})},g=e=>{if(0===e.length)return[];const t=e.map((e=>({start:Math.floor(e.start/1e3),end:Math.floor(e.end/1e3)}))).sort(((e,t)=>e.start-t.start)),o=[t[0]];for(let a=1;a<t.length;a++){const e=t[a],s=o[o.length-1];e.start<=s.end+1?s.end=Math.max(s.end,e.end):o.push(e)}return o},h=e=>e.reduce(((e,t)=>e+(t.end-t.start)),0),f=()=>{const[e,t]=(0,a.useState)(""),o=()=>{const e=new Date,t=new Date;t.setHours(24,0,0,0);const o=t.getTime()-e.getTime(),a=Math.floor(o/36e5),s=Math.floor(o%36e5/6e4);return"".concat(a,"h ").concat(s,"m")};return(0,a.useEffect)((()=>{t(o());const e=setInterval((()=>{t(o())}),6e4);return()=>clearInterval(e)}),[]),(0,m.jsxs)("div",{className:"text-xs text-gray-400 mt-2 text-center",children:["\ud83c\udf19 Auto-reset in: ",e]})};function p(){const[e,t]=(0,a.useState)(0),[o,n]=(0,a.useState)(0),[p,x]=(0,a.useState)(0),[b,v]=(0,a.useState)([]),[y,S]=(0,a.useState)(!1),[w,I]=(0,a.useState)([]),[j,k]=(0,a.useState)(Date.now()),{user:N}=(0,d.As)(),C=(new Date).toISOString().split("T")[0],D=()=>{localStorage.removeItem("uptimePeriods_".concat(C)),localStorage.removeItem("sessionCount_".concat(C)),localStorage.removeItem("sessionStart"),localStorage.removeItem("sessionActive"),t(0),n(0),x(0),v([]),S(!1),I([]),_()},T=()=>{const e=localStorage.getItem("uptimePeriods_".concat(C));if(e)try{const o=JSON.parse(e);I(o);const a=g(o),s=h(a);x(s);const r=parseInt(localStorage.getItem("sessionCount_".concat(C))||"0",10);return t(r),o}catch(o){return console.error("Error loading uptime:",o),I([]),[]}return[]},M=(e,t)=>{const o=localStorage.getItem("uptimePeriods_".concat(C));let a=[];if(o)try{a=JSON.parse(o)}catch(r){console.error("Parsing error:",r)}a.push({start:e,end:t}),localStorage.setItem("uptimePeriods_".concat(C),JSON.stringify(a));const s=parseInt(localStorage.getItem("sessionCount_".concat(C))||"0",10);return localStorage.setItem("sessionCount_".concat(C),(s+1).toString()),a},_=()=>{y||(localStorage.setItem("sessionStart",Date.now()),localStorage.setItem("sessionActive","true"),S(!0))};(0,a.useEffect)((()=>{let e=(new Date).toISOString().split("T")[0];const o=()=>{const o=(new Date).toISOString().split("T")[0];o!==e&&(console.log("\ud83d\udd04 Day changed from ".concat(e," to ").concat(o)),localStorage.removeItem("uptimePeriods_".concat(e)),localStorage.removeItem("sessionCount_".concat(e)),localStorage.removeItem("sessionStart"),localStorage.removeItem("sessionActive"),t(0),n(0),x(0),v([]),S(!1),I([]),e=o,setTimeout((()=>_()),100))},a=()=>{const e=(()=>{const e=new Date,t=new Date;return t.setHours(24,0,0,0),t.getTime()-e.getTime()})(),t=setTimeout((()=>{console.log("\ud83c\udf05 Midnight reset triggered"),D(),a()}),e);return console.log("\u23f0 Midnight reset scheduled in ".concat(Math.round(e/1e3/60)," minutes")),t},s=setInterval(o,6e4),r=()=>{document.hidden||o()};document.addEventListener("visibilitychange",r),o();const i=a();return()=>{clearInterval(s),clearTimeout(i),document.removeEventListener("visibilitychange",r)}}),[]),(0,a.useEffect)((()=>{const e="true"===localStorage.getItem("sessionActive");S(e),T(),e||_()}),[C]),(0,a.useEffect)((()=>{const e=setInterval((()=>{if(y){const t=parseInt(localStorage.getItem("sessionStart"),10);if(t){const o=localStorage.getItem("uptimePeriods_".concat(C));let a=[];if(o)try{a=JSON.parse(o)}catch(e){}const s=Date.now(),r=[...a,{start:t,end:s}],n=g(r),i=h(n);x(i),k(s)}}}),1e3);return()=>clearInterval(e)}),[y,C]),(0,a.useEffect)((()=>{const e=setInterval((()=>{if(y){const e=new Date,t=e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),o=Math.floor(p/60);v((a=>[...a,{time:t,uptime:o,timestamp:e.getTime()}].slice(-60)))}}),6e4);return()=>clearInterval(e)}),[y,p]),(0,a.useEffect)((()=>{const e=()=>{if(document.hidden&&y){const e=parseInt(localStorage.getItem("sessionStart"),10);e&&(M(e,Date.now()),localStorage.setItem("sessionActive","false"),S(!1),T())}else document.hidden||y||_()},t=()=>{if(y){const e=parseInt(localStorage.getItem("sessionStart"),10);e&&M(e,Date.now()),localStorage.setItem("sessionActive","false")}};return document.addEventListener("visibilitychange",e),window.addEventListener("beforeunload",t),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("beforeunload",t)}}),[y,C]),(0,a.useEffect)((()=>{if(!N)return;(async()=>{try{const e=N.uid,t=new Date,o=new Date(t.setHours(0,0,0,0)),a=new Date(t.setHours(23,59,59,999)),i=(0,r.P)((0,r.rJ)(s.db,"userInteractions"),(0,r._M)("userId","==",e),(0,r._M)("action","==","simulate_scenario"),(0,r._M)("timestamp",">=",r.Dc.fromDate(o)),(0,r._M)("timestamp","<=",r.Dc.fromDate(a))),l=await(0,r.GG)(i);n(l.size)}catch(e){console.error("Fetch error:",e)}})()}),[N]);const A={labels:b.map((e=>e.time)),datasets:[{label:"Uptime (minutes)",data:b.map((e=>e.uptime)),borderColor:"#06b6d4",backgroundColor:e=>{const t=e.chart,{ctx:o,chartArea:a}=t;if(!a)return null;const s=o.createLinearGradient(0,a.top,0,a.bottom);return s.addColorStop(0,"rgba(6, 182, 212, 0.3)"),s.addColorStop(.5,"rgba(6, 182, 212, 0.1)"),s.addColorStop(1,"rgba(6, 182, 212, 0.05)"),s},borderWidth:3,tension:.4,fill:!0,pointRadius:6,pointHoverRadius:8,pointBackgroundColor:"#06b6d4",pointBorderColor:"#ffffff",pointBorderWidth:2,pointHoverBackgroundColor:"#0891b2",pointHoverBorderColor:"#ffffff",pointHoverBorderWidth:3,shadowColor:"rgba(6, 182, 212, 0.3)",shadowBlur:10,shadowOffsetX:0,shadowOffsetY:4}]},E=(0,c.Zp)();return(0,m.jsxs)("div",{className:"p-6 bg-gray-50 dark:bg-gray-800 min-h-screen",children:[(0,m.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-10",children:[(0,m.jsx)(u,{title:"Total Sessions Today",value:e,icon:(0,m.jsx)("i",{className:"fas fa-history"})}),(0,m.jsx)(u,{title:"Scenarios Run Today",value:o,icon:(0,m.jsx)("i",{className:"fas fa-tasks"})}),(0,m.jsx)(u,{title:"Total Uptime Today",value:(e=>{const t=Math.floor(e/3600),o=Math.floor(e%3600/60),a=e%60;return"".concat(t,"h ").concat(o,"m ").concat(a,"s")})(p),icon:(0,m.jsx)("i",{className:"fas fa-clock"})})]}),(0,m.jsxs)(l.P.div,{className:"p-8 rounded-3xl bg-white dark:bg-gray-900 shadow-xl border border-gray-100 dark:border-gray-700",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,m.jsxs)("div",{className:"flex items-center gap-3",children:[(0,m.jsx)("div",{className:"w-3 h-3 bg-emerald-500 rounded-full animate-pulse"}),(0,m.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"\ud83d\udcc8 Live Uptime Trend"})]}),(0,m.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Last updated: ",new Date(j).toLocaleTimeString()]})]}),(0,m.jsx)("div",{className:"h-96 relative",children:(0,m.jsx)(i.Line,{data:A,options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!0,position:"top",labels:{color:"#6b7280",font:{size:14,weight:"500"},usePointStyle:!0,pointStyle:"circle",padding:20}},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.95)",titleColor:"#f9fafb",bodyColor:"#f9fafb",borderColor:"#06b6d4",borderWidth:1,cornerRadius:12,displayColors:!1,titleFont:{size:14,weight:"600"},bodyFont:{size:13,weight:"400"},padding:12,callbacks:{title:e=>"Time: ".concat(e[0].label),label:e=>"Uptime: ".concat(e.parsed.y," minutes")}}},scales:{x:{display:!0,title:{display:!0,text:"Time",color:"#6b7280",font:{size:13,weight:"500"}},ticks:{color:"#9ca3af",font:{size:12},maxTicksLimit:10},grid:{color:"rgba(156, 163, 175, 0.1)",borderDash:[3,3]},border:{color:"rgba(156, 163, 175, 0.2)"}},y:{display:!0,title:{display:!0,text:"Minutes",color:"#6b7280",font:{size:13,weight:"500"}},beginAtZero:!0,ticks:{color:"#9ca3af",font:{size:12},callback:e=>"".concat(e,"m")},grid:{color:"rgba(156, 163, 175, 0.1)",borderDash:[3,3]},border:{color:"rgba(156, 163, 175, 0.2)"}}},elements:{line:{tension:.4}},animation:{duration:1e3,easing:"easeInOutQuart"}}})}),(0,m.jsxs)("div",{className:"mt-6 text-center",children:[(0,m.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:["\ud83d\udcca Updates every minute \u2022 ",b.length," data points \u2022 Session: ",y?"\ud83d\udfe2 Active":"\ud83d\udd34 Inactive"]}),(0,m.jsxs)("div",{className:"flex justify-center gap-6 text-xs text-gray-400",children:[(0,m.jsx)("span",{children:"\ud83d\udd04 Auto-refresh: 1min"}),(0,m.jsx)("span",{children:"\ud83d\udcc8 Chart history: 1hr"}),(0,m.jsx)("span",{children:"\ud83d\udcbe Data retention: 24hr"})]})]}),(0,m.jsx)(f,{})]}),(0,m.jsxs)("div",{className:"mt-10 text-center",children:[(0,m.jsx)("p",{className:"text-gray-500 mb-2",children:"Click to view full analytics"}),(0,m.jsx)(l.P.button,{whileTap:{scale:.95},whileHover:{scale:1.05},onClick:()=>E("/analytics"),className:"px-6 py-3 bg-yellow-400 dark:bg-yellow-500 text-black dark:text-white rounded-xl shadow hover:bg-yellow-500 dark:hover:bg-yellow-600 transition",children:"\ud83d\udcca View Full Analytics"}),(0,m.jsx)("br",{}),(0,m.jsx)("button",{onClick:D,className:"mt-4 text-xs underline text-red-500",children:"Clear Today's Data (Manual)"})]})]})}}}]);
//# sourceMappingURL=662.506dd797.chunk.js.map