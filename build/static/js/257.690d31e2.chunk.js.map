{"version":3,"file":"static/js/257.690d31e2.chunk.js","mappings":"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","sources":["components/History.js"],"sourcesContent":["import { useState, useEffect, useMemo } from \"react\";\r\nimport { db } from \"../firebase\";\r\nimport {\r\n  collection,\r\n  query,\r\n  orderBy,\r\n  getDocs,\r\n  where,\r\n  startAfter,\r\n  limit,\r\n} from \"firebase/firestore\";\r\nimport { useAuth } from \"../AuthContext\";\r\nimport { debounce } from \"lodash\";\r\n\r\nconst PAGE_SIZE = 5;\r\n\r\nconst History = () => {\r\n  const { user } = useAuth();\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [debouncedSearch, setDebouncedSearch] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n  const [usingFallback, setUsingFallback] = useState(false);\r\n  const [chatHistory, setChatHistory] = useState([]);\r\n  const [userInteractions, setUserInteractions] = useState([]);\r\n  const [lastVisible, setLastVisible] = useState(null);\r\n  const [loadingMore, setLoadingMore] = useState(false);\r\n  const [hasMore, setHasMore] = useState(true);\r\n\r\n  // Debounce input\r\n  const debounceInput = useMemo(\r\n    () => debounce((value) => setDebouncedSearch(value), 300),\r\n    []\r\n  );\r\n\r\n  useEffect(() => {\r\n    return () => debounceInput.cancel();\r\n  }, [debounceInput]);\r\n\r\n  useEffect(() => {\r\n    debounceInput(searchQuery);\r\n  }, [searchQuery, debounceInput]);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      loadChatHistory();\r\n      loadUserInteractions(false);\r\n    }\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => setLoading(false), 4000);\r\n    return () => clearTimeout(timer);\r\n  }, []);\r\n\r\n  const loadChatHistory = async () => {\r\n    try {\r\n      const q = query(\r\n        collection(db, \"users\", user.uid, \"userInteractions\"),\r\n        orderBy(\"timestamp\", \"desc\")\r\n      );\r\n      const snapshot = await getDocs(q);\r\n      setChatHistory(snapshot.docs.map((doc) => doc.data()));\r\n    } catch (error) {\r\n      console.error(\"❌ Error loading chat history:\", error);\r\n    }\r\n  };\r\n\r\n  const loadUserInteractions = async (loadMore = false) => {\r\n    try {\r\n      setLoadingMore(loadMore);\r\n      const userInteractionsRef = collection(db, \"userInteractions\");\r\n\r\n      const q = query(\r\n        userInteractionsRef,\r\n        where(\"userId\", \"==\", user.uid),\r\n        orderBy(\"timestamp\", \"desc\"),\r\n        ...(loadMore && lastVisible ? [startAfter(lastVisible)] : []),\r\n        limit(PAGE_SIZE)\r\n      );\r\n\r\n      const snapshot = await getDocs(q);\r\n      const interactions = snapshot.docs.map((doc) => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n      }));\r\n\r\n      setUserInteractions((prev) =>\r\n        loadMore ? [...prev, ...interactions] : interactions\r\n      );\r\n\r\n      setLastVisible(snapshot.docs[snapshot.docs.length - 1]);\r\n      setHasMore(snapshot.docs.length === PAGE_SIZE);\r\n      setLoadingMore(false);\r\n    } catch (error) {\r\n      console.error(\"❌ Error fetching user interactions:\", error);\r\n      setLoadingMore(false);\r\n    }\r\n  };\r\n\r\n  const { history: activeHistory, fallback: isFallback } = useMemo(() => {\r\n    if (userInteractions.length > 0) return { history: userInteractions, fallback: false };\r\n    if (chatHistory.length > 0) return { history: chatHistory, fallback: true };\r\n    return { history: [], fallback: false };\r\n  }, [userInteractions, chatHistory]);\r\n\r\n  const filteredInteractions = useMemo(() => {\r\n    return debouncedSearch\r\n      ? activeHistory.filter((interaction) =>\r\n          interaction.details?.scenarios?.some((scenario) =>\r\n            scenario.toLowerCase().includes(debouncedSearch.toLowerCase())\r\n          )\r\n        )\r\n      : activeHistory;\r\n  }, [debouncedSearch, activeHistory]);\r\n\r\n  const suggestions = useMemo(() => {\r\n    return debouncedSearch\r\n      ? activeHistory.flatMap((interaction) =>\r\n          interaction.details?.scenarios?.filter((scenario) =>\r\n            scenario.toLowerCase().startsWith(debouncedSearch.toLowerCase())\r\n          ) || []\r\n        )\r\n      : [];\r\n  }, [debouncedSearch, activeHistory]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"animate-pulse space-y-6 max-w-6xl mx-auto p-8\">\r\n        <div className=\"space-y-4\">\r\n          <div className=\"h-8 bg-gradient-to-r from-slate-300 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-xl\"></div>\r\n          <div className=\"h-12 bg-gradient-to-r from-blue-200 to-purple-200 dark:from-blue-800 dark:to-purple-800 rounded-xl\"></div>\r\n          <div className=\"space-y-3\">\r\n            <div className=\"h-20 bg-gradient-to-r from-slate-200 to-slate-100 dark:from-slate-700 dark:to-slate-600 rounded-2xl\"></div>\r\n            <div className=\"h-20 bg-gradient-to-r from-slate-200 to-slate-100 dark:from-slate-700 dark:to-slate-600 rounded-2xl\"></div>\r\n            <div className=\"h-20 bg-gradient-to-r from-slate-200 to-slate-100 dark:from-slate-700 dark:to-slate-600 rounded-2xl\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"text-center\">\r\n        <h1 className=\"text-3xl font-bold bg-gradient-to-r from-emerald-600 via-teal-600 to-cyan-600 bg-clip-text text-transparent mb-2\">\r\n          Interaction History\r\n        </h1>\r\n        <div className=\"w-20 h-1 bg-gradient-to-r from-emerald-500 to-cyan-500 mx-auto rounded-full\"></div>\r\n      </div>\r\n\r\n      {/* Fallback Warning */}\r\n      {isFallback && (\r\n        <div className=\"bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/30 dark:to-orange-900/30 border border-amber-200 dark:border-amber-700/50 rounded-2xl p-4 backdrop-blur-sm\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <div className=\"flex-shrink-0\">\r\n              <svg className=\"w-6 h-6 text-amber-600 dark:text-amber-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n              </svg>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-sm font-medium text-amber-800 dark:text-amber-200\">\r\n                Showing unsynced local history\r\n              </p>\r\n              <p className=\"text-xs text-amber-600 dark:text-amber-300\">\r\n                Log in to sync with your account\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Search Bar */}\r\n      <div className=\"relative\">\r\n        <div className=\"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none\">\r\n          <svg className=\"w-5 h-5 text-slate-400 dark:text-slate-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\r\n          </svg>\r\n        </div>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search past queries...\"\r\n          className=\"w-full pl-12 pr-4 py-4 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border border-slate-200 dark:border-slate-700 rounded-2xl text-slate-900 dark:text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-transparent transition-all duration-300 shadow-lg\"\r\n          value={searchQuery}\r\n          onChange={(e) => setSearchQuery(e.target.value)}\r\n        />\r\n      </div>\r\n\r\n      {/* Search Suggestions */}\r\n      {suggestions.length > 0 && (\r\n        <div className=\"bg-white/90 dark:bg-slate-800/90 backdrop-blur-lg border border-slate-200 dark:border-slate-700 rounded-2xl shadow-xl overflow-hidden\">\r\n          <div className=\"max-h-40 overflow-y-auto\">\r\n            {suggestions.map((suggestion, index) => (\r\n              <div\r\n                key={index}\r\n                className=\"p-4 hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition-colors duration-200 border-b border-slate-100 dark:border-slate-700 last:border-b-0\"\r\n                onClick={() => setSearchQuery(suggestion)}\r\n              >\r\n                <div className=\"flex items-center space-x-3\">\r\n                  <svg className=\"w-4 h-4 text-slate-400 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z\" />\r\n                  </svg>\r\n                  <span className=\"text-sm text-slate-700 dark:text-slate-300 truncate\">\r\n                    {suggestion}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Interactions List */}\r\n      <div className=\"bg-white/60 dark:bg-slate-800/60 backdrop-blur-lg rounded-3xl border border-white/20 dark:border-slate-700/50 shadow-2xl overflow-hidden\">\r\n        <div className=\"max-h-96 overflow-y-auto p-6\">\r\n          {filteredInteractions.length > 0 ? (\r\n            <div className=\"space-y-4\">\r\n              {filteredInteractions.map((interaction, index) => (\r\n                <div\r\n                  key={interaction.id}\r\n                  className=\"group bg-gradient-to-r from-white/80 to-slate-50/80 dark:from-slate-800/80 dark:to-slate-700/80 backdrop-blur-sm rounded-2xl p-6 border border-slate-200/50 dark:border-slate-600/50 hover:shadow-lg transition-all duration-300 hover:scale-[1.02] animate-in fade-in\"\r\n                  style={{ animationDelay: `${index * 100}ms` }}\r\n                >\r\n                  <div className=\"flex items-start space-x-4\">\r\n                    <div className=\"flex-shrink-0 mt-1\">\r\n                      <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg\">\r\n                        <svg className=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                        </svg>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <h3 className=\"font-semibold text-slate-900 dark:text-slate-100 mb-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors\">\r\n                        {interaction.action}\r\n                      </h3>\r\n                      {interaction.details?.scenarios && (\r\n                        <p className=\"text-sm text-slate-600 dark:text-slate-400 mb-3 leading-relaxed\">\r\n                          {interaction.details.scenarios.join(\", \")}\r\n                        </p>\r\n                      )}\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <svg className=\"w-4 h-4 text-slate-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                        </svg>\r\n                        <span className=\"text-xs text-slate-500 dark:text-slate-400\">\r\n                          {interaction.timestamp?.toDate?.().toLocaleString() ?? \"Recent\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-12\">\r\n              <div className=\"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-700 dark:to-slate-600 rounded-full flex items-center justify-center\">\r\n                <svg className=\"w-8 h-8 text-slate-400 dark:text-slate-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                </svg>\r\n              </div>\r\n              <h3 className=\"text-lg font-semibold text-slate-700 dark:text-slate-200 mb-2\">\r\n                No interactions found\r\n              </h3>\r\n              <p className=\"text-sm text-slate-500 dark:text-slate-400\">\r\n                Your interaction history will appear here as you explore.\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Load More Button */}\r\n        {hasMore && !loadingMore && filteredInteractions.length > 0 && (\r\n          <div className=\"p-6 border-t border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50\">\r\n            <button\r\n              onClick={() => loadUserInteractions(true)}\r\n              className=\"w-full px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white font-semibold rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-emerald-500/50\"\r\n            >\r\n              Load More Interactions\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        {/* Loading More Indicator */}\r\n        {loadingMore && (\r\n          <div className=\"p-6 border-t border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50\">\r\n            <div className=\"flex items-center justify-center space-x-3\">\r\n              <div className=\"w-5 h-5 border-2 border-emerald-500/30 border-t-emerald-500 rounded-full animate-spin\"></div>\r\n              <span className=\"text-sm text-slate-600 dark:text-slate-400\">\r\n                Loading more interactions...\r\n              </span>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <style jsx>{`\r\n        @keyframes fade-in {\r\n          from {\r\n            opacity: 0;\r\n            transform: translateY(10px);\r\n          }\r\n          to {\r\n            opacity: 1;\r\n            transform: translateY(0);\r\n          }\r\n        }\r\n        \r\n        .animate-in {\r\n          animation: fade-in 0.6s ease-out forwards;\r\n        }\r\n        \r\n        .backdrop-blur-sm {\r\n          backdrop-filter: blur(4px);\r\n        }\r\n        \r\n        .backdrop-blur-lg {\r\n          backdrop-filter: blur(16px);\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default History;"],"names":["History","user","useAuth","searchQuery","setSearchQuery","useState","debouncedSearch","setDebouncedSearch","loading","setLoading","usingFallback","setUsingFallback","chatHistory","setChatHistory","userInteractions","setUserInteractions","lastVisible","setLastVisible","loadingMore","setLoadingMore","hasMore","setHasMore","debounceInput","useMemo","debounce","value","useEffect","cancel","loadChatHistory","loadUserInteractions","timer","setTimeout","clearTimeout","async","q","query","collection","db","uid","orderBy","snapshot","getDocs","docs","map","doc","data","error","console","loadMore","arguments","length","undefined","userInteractionsRef","where","startAfter","limit","interactions","_objectSpread","id","prev","history","activeHistory","fallback","isFallback","filteredInteractions","filter","interaction","_interaction$details","_interaction$details$","details","scenarios","some","scenario","toLowerCase","includes","suggestions","flatMap","_interaction$details2","_interaction$details3","startsWith","_jsx","className","children","_jsxs","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","type","placeholder","onChange","e","target","suggestion","index","onClick","_interaction$details4","_interaction$timestam","_interaction$timestam2","_interaction$timestam3","style","animationDelay","concat","action","join","timestamp","toDate","call","toLocaleString","jsx"],"sourceRoot":""}